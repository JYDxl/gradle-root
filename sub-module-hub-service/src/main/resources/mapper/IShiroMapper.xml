<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="org.github.auth.shiro.mapper.IShiroMapper">
  <select id="queryAuthorInfo" resultType="org.github.shiro.AuthorInfo">
    select
      role_code             as role_code,
      group_concat(m.perms) as perm_codes
    from sys_user_role ur
           left join sys_role r on ur.role_id = r.role_id
           left join sys_role_menu rm on ur.role_id = rm.role_id
           left join sys_menu m on rm.menu_id = m.menu_id and m.perms != ''
    where ur.user_id = #{userId}
      and m.perms != ''
    group by role_code
  </select>

  <select id="queryUserInfo" resultType="org.github.auth.shiro.model.UserDTO">
    select *
    from sys_user
    where username = #{username}
  </select>
</mapper>
